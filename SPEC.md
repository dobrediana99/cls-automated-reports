Ești un AI Software Engineer cu acces complet la codul aplicației existente. Ai permisiunea să refactorizezi, să muți logică din frontend în backend, să creezi module noi, să reorganizezi structura proiectului și să modifici arhitectura, atât timp cât respecți cerințele funcționale și tehnice de mai jos. Scopul tău este să transformi aplicația actuală într-un sistem backend automatizat de raportare, trimitere email și analiză AI, pornind de la logica deja implementată.

Aplicația existentă extrage date din Monday.com prin GraphQL API, calculează metrici per angajat, per departament și la nivel de companie și generează un raport complet în format Microsoft Excel (.xlsx) pentru un interval de timp ales manual. Această logică de calcul este corectă și validată și trebuie reutilizată sau portată server-side, nu rescrisă arbitrar. Monday.com este singura sursă de date. Fișierele Excel generate sunt doar output, nu sursă de input.

Noua aplicație trebuie să ruleze ca backend Node.js, gândit pentru deploy pe Google Cloud Run, cu joburi declanșate prin Google Cloud Scheduler. Nu folosi cron intern sau joburi programate în proces, deoarece aplicația poate fi oprită și repornită. Creează endpoint-uri HTTP dedicate pentru execuția joburilor, de tipul /run/weekly și /run/monthly, care vor fi apelate de Cloud Scheduler. Protejează aceste endpoint-uri prin validare OIDC: Cloud Scheduler trimite un ID token (Authorization: Bearer &lt;id_token&gt;); backend-ul validează token-ul cu google-auth-library (audience = URL-ul serviciului Cloud Run). Opțional se poate restricționa apelantul la un anumit service account (SCHEDULER_SA_EMAIL). (Deprecated: anterior se folosea X-Job-Token / JOB_TOKEN.)

Există un fișier de configurare hardcodat care definește structura organizației, cu aproximativ 17 persoane, dintre care 3 sunt manageri. Acest fișier conține pentru fiecare persoană numele, emailul, mondayUserId, departamentul, targetul, rolul (employee sau manager) și un flag de activitate. Acest fișier reprezintă sursa de adevăr pentru destinatarii emailurilor și trebuie folosit atât pentru rapoartele săptămânale, cât și pentru cele lunare.

În fiecare săptămână, în fiecare zi de luni la ora 09:30, ora Europe/Bucharest, trebuie să se trimită automat emailuri pentru săptămâna calendaristică anterioară, definită ca intervalul luni–duminică. Toți angajații, inclusiv managerii, primesc un email simplu care conține doar datele personale sub formă de tabel, fără analiză, interpretări sau recomandări. Managerii primesc, pe lângă emailul personal, și raportul complet al companiei sub formă de fișier Excel atașat. Pentru rapoartele săptămânale nu trebuie folosit niciun LLM sub nicio formă.

În fiecare lună, în ziua de 5 la ora 09:30, ora Europe/Bucharest, trebuie să se trimită emailuri pentru luna calendaristică anterioară. Toți angajații, inclusiv managerii, primesc un email cu o analiză personală complexă bazată strict pe datele deja calculate. Analiza trebuie să respecte structura și regulile definite în documentația furnizată și să fie generată de un LLM doar pe baza unui input structurat. LLM-ul nu are voie să calculeze cifre, să estimeze date lipsă sau să inventeze valori. Dacă lipsesc date, acest lucru trebuie menționat explicit. Tonul trebuie să fie profesional, clar, la persoana a doua, fără comparații între angajați. Structura emailului trebuie să fie fixă și consistentă. Managerii primesc, pe lângă analiza personală, raportul complet al companiei sub formă de Excel și un email separat cu analiză AI la nivel de companie.

Toate cheile sensibile, inclusiv token-ul Monday.com, credențialele de email și cheia LLM, trebuie să existe exclusiv în backend, citite din variabile de mediu sau din Secret Manager. Nu trebuie să existe chei sau secrete în frontend. Aplicația trebuie să aibă logging clar pentru fiecare execuție de job și să implementeze un mecanism de idempotency pentru a preveni trimiterea de emailuri duplicate în cazul în care Cloud Scheduler retrimite un request. Pentru starea joburilor trebuie folosit un storage persistent, de exemplu Firestore.

Dacă LLM-ul nu este disponibil sau apare o eroare în pasul de analiză, aplicația trebuie să trimită fallback un email de tip data-only, astfel încât livrarea rapoartelor să nu fie blocată. Codul trebuie organizat clar, separat pe module pentru accesul la Monday.com, calculul rapoartelor, generarea fișierelor Excel, trimiterea emailurilor și analiza AI. Ai libertatea să reorganizezi structura proiectului după cum consideri corect, atât timp cât funcționalitatea cerută este respectată și logica de calcul existentă nu este alterată nejustificat.

Obiectivul final este să livrezi un backend robust, automat, sigur și ușor de extins, care să transforme aplicația existentă într-un sistem complet de raportare automată, cu rapoarte săptămânale data-only și rapoarte lunare cu analiză AI, livrate prin email, folosind Monday.com ca sursă unică de date.